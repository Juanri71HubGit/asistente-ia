<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Asistente Humana</title>
    <style>
        body { margin: 0; padding: 20px; background: #0f172a; color: white; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; }
        .avatar { width: 250px; height: 250px; border-radius: 50%; border: 4px solid #38bdf8; overflow: hidden; margin-bottom: 20px; box-shadow: 0 0 20px #38bdf8; }
        video { width: 100%; height: 100%; object-fit: cover; }
        #btn-hablar { padding: 20px 40px; border-radius: 50px; border: none; background: #38bdf8; color: white; font-weight: bold; font-size: 18px; cursor: pointer; }
        #status { margin-top: 20px; color: #38bdf8; font-style: italic; text-align: center; }
    </style>
</head>
<body>

    <div class="avatar">
        <video id="vid" autoplay loop muted playsinline>
            <source src="asistente.mp4" type="video/mp4">
        </video>
    </div>

    <div id="status">Lista para ayudarte</div>
    <br>
    <button id="btn-hablar">ðŸŽ¤ HABLAR CON ELLA</button>

    <script>
        const btn = document.getElementById('btn-hablar');
        const status = document.getElementById('status');
        const webhookURL = 'https://hook.eu1.make.com/plu328ps7314ezeaojep1gpgswq2s729';

        const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        recognition.lang = 'es-ES';

        btn.onclick = () => {
            recognition.start();
            status.innerText = "Escuchando...";
            btn.style.opacity = "0.5";
        };

        recognition.onresult = async (event) => {
            const texto = event.results[0][0].transcript;
            status.innerText = "TÃº: " + texto;
            btn.innerText = "Generando voz humana...";

            try {
                const response = await fetch(webhookURL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ text: texto })
                });

                if (response.ok) {
                    const audioBlob = await response.blob();
                    const audioUrl = URL.createObjectURL(audioBlob);
                    const audio = new Audio(audioUrl);
                    
                    status.innerText = "Respondiendo...";
                    audio.play();
                }
            } catch (e) {
                status.innerText = "Error de conexiÃ³n";
            } finally {
                btn.innerText = "ðŸŽ¤ HABLAR CON ELLA";
                btn.style.opacity = "1";
            }
        };
    </script>
</body>
</html>
